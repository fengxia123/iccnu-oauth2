{"name":"Iccnu-oauth2","tagline":"iccnu的oauth2认证服务说明文档","body":"# ICCNU Oauth2 Authentication Flow Instruction\r\n\r\n***\r\n\r\n## Before You Begin\r\n这里是租户应用的调用认证主站 OAuth2 的认证服务的认证流程。这个文档给租户应用的开发者参考。\r\n\r\n作为应用的开发者，你需要针对应用的不同类型，对需要采用的认证流程进行选择。B/S应用需要参考Authorization Code Grant Flow，C/S应用需要参考Resource Owner Password Credentials Grant Flow。\r\n\r\n认证流程结束后，租户应用需要根据自己的应用是否已上线并存在用户群体，继续创建新用户或绑定已有账户的登录流程。\r\n\r\n附注：\r\n\r\n**认证站点:** http://www.iccnu.net/\r\n\r\n**认证页面:** http://www.iccnu.net/oauth2/authorize\r\n\r\n**AccessToken API End Point:** http://www.iccnu.net/api/oauth2/token\r\n\r\n**Me API End Point:** http://www.iccnu.net/api/oauth2/me\r\n  \r\n***\r\n\r\n####1.租户为B/S应用\r\n需要参考 Authorization Code Grant Flow，用户在认证站点登录并跳转至您的应用后，应提示用户绑定已有账户或直接创建新用户，后进入登录状态。\r\n####2.租户为C/S应用\r\n需要参考 Resource Owner Password Credentials Grant Flow，用户登录至您的应用后，应提示用户绑定已有账户或直接创建新用户，后进入登录状态。\r\n\r\n##1 租户为B/S应用: Authorization Code Grant Flow\r\n\r\n####使用先决条件\r\n1. 你的用户需要现在ICCNU上注册为用户。\r\n\r\n2. 你需要将你的应用申请成为ICCNU认证服务的租户。\r\n\r\n租户应用需要为站点提供的信息包括\r\n\r\n   **回调地址** \"redirectURI\" : \"http://localhost:8080/account/login\"\r\n\r\n   **租户应用Id** \"id\" : \"code_test\"\r\n\r\n   **租户应用密码** \"secret\" : *****\r\n\r\n   **主页地址** \"homeURI\" : \"http://localhost:8080/\"\r\n\r\n   **租户应用名** \"name\" : \"测试应用名1\"\r\n\r\n   **租户应用描述** \"description\" : \"这里是测试应用1的描述信息\"\r\n\r\n   **认证类型** \"authType\" : \"code\"\r\n\r\n其中，回调地址、租户应用Id及租户应用密码为Authorization Code Grant Flow认证流程中需要用到的必须字段; 主页地址，租户应用名, 租户应用描述为显示给用户的字段，不是必须的；认证类型在Authorization Code Grant Flow中固定为\"Code\"。   \r\n\r\n####认证流程\r\n1 用户点击租户应用网页上的“使用ICCNU账户登录”时，携带租户注册参数（包括回调地址，租户应用Id，认证类型等）跳转到认证页面。\r\n\r\n2 用户登录后，认证页面呈现你的应用信息及用户个人信息，用户授权租户应用（用户授权租户、表示用户允许租户应用通过获得到的AccessToken访问认证主站的服务，包括网盘服务，资源服务等，获得到用户的资源）之后，携带code跳转回你的应用的回调页面。\r\n\r\n3 租户应用回调页面在处理逻辑中，携带code及租户的信息（包括回调地址，租户应用Id，租户应用密码，认证类型）及申请访问的服务域（暂为全域）等，调用认证站点的token服务，得到用户的AccessToken。\r\n\r\n4 租户应用通过AccessToken调用认证站点的Me服务，得到用户的认证信息，认证流程结束。\r\n\r\n此时租户应用已经知道调用认证站点ICCNU登录的用户的基本信息，可以继续租户应用自己的业务（绑定已存在的本地用户或者根据登录信息创建用户等等）。\r\n\r\n##1 租户为C/S应用: Resource Owner Password Credentials Grant Flow\r\n\r\n####使用先决条件\r\n1. 你的用户需要现在ICCNU上注册为用户。\r\n\r\n2. 你需要将你的应用申请成为ICCNU认证服务的租户。\r\n\r\n租户应用需要为站点提供的信息包括\r\n\r\n   **租户应用Id** \"id\" : \"code_test\"\r\n\r\n   **租户应用密码** \"secret\" : *****\r\n\r\n   **主页地址 \"homeURI\"** : \"http://localhost:8080/\"\r\n\r\n   **租户应用名** \"name\" : \"测试应用名1\"\r\n\r\n   **租户应用描述** \"description\" : \"这里是测试应用1的描述信息\"\r\n\r\n   **认证类型** \"authType\" : \"resource_owner\"\r\n\r\n其中，租户应用Id及租户应用密码为Resource Owner Password Credentials Grant Flow认证流程中需要用到的必须字段; 主页地址，租户应用名, 租户应用描述为显示给用户的字段，不是必须的；认证类型在Resource Owner Password Credentials Grant Flow中固定为\"resource_owner\"。   \r\n\r\nC/S应用并不是在浏览器中进行认证流程，所以不需要提供回调地址字段。\r\n\r\n####认证流程\r\n\r\n1 用户点击客户端的“使用ICCNU账户登录”时，输入在认证站点上注册的用户名与密码。\r\n\r\n2 客户端在后台携带用户输入的用户名与密码及租户的信息（包括回调地址，租户应用Id，租户应用密码，认证类型）及申请访问的服务域（暂为全域）等，调用认证站点的token服务，得到用户的AccessToken。\r\n\r\n3 租户应用通过AccessToken调用认证站点的Me服务，得到用户的认证信息，认证流程结束。\r\n\r\n此时租户应用已经知道登录用户的基本信息，可以继续租户应用自己的业务（绑定已存在的本地用户或者根据登录信息创建用户等等）。\r\n\r\nPS: B/S站点亦可以使用 Resource Owner Password Credentials Grant, 但是不建议这样做。\r\n\r\n##参考\r\nAuthorization Code Grant\r\nhttps://tools.ietf.org/html/rfc6749#section-4.1\r\n\r\nResource Owner Password Credentials Grant\r\nhttps://tools.ietf.org/html/rfc6749#section-4.3\r\n\r\n认证流程的具体技术细节，传参方式等继续更新\r\n\r\n##包中的内容\r\ndot net BS Authorization Code Grant：dot net B/S 例子\r\n\r\ndot net CS Resource Owner Password Credentials Grant：dot net C/S 例子\r\n\r\nnode.js BS Authorization Code Grant：node.js B/S 例子","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}